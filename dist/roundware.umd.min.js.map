{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///roundware.umd.min.js","webpack:///webpack/bootstrap ed42b3995e5f13b32b13","webpack:///./src/shims.js","webpack:///./src/roundware.js","webpack:///./src/api-client.js","webpack:///./src/asset.js","webpack:///./src/envelope.js","webpack:///./src/geo-position.js","webpack:///./src/project.js","webpack:///./src/session.js","webpack:///./src/speaker.js","webpack:///./src/stream.js","webpack:///./src/user.js","webpack:///./~/loglevel/lib/loglevel.js","webpack:///./~/process/browser.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","process","_loglevel","logger","obj","newObj","key","default","env","ROUNDWARE_DEBUG","setDefaultLevel","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","length","descriptor","writable","protoProps","staticProps","_project","_session","_speaker","_geoPosition","_stream","_asset","_shims","_apiClient","_user","_envelope","Roundware","window","options","arguments","undefined","_serverUrl","serverUrl","_projectId","projectId","_speakerFilters","speakerFilters","_assetFilters","assetFilters","ApiClient","apiClient","navigator","user","User","geoPosition","GeoPosition","session","Session","geoListenEnabled","project","Project","stream","Stream","speaker","Speaker","asset","Asset","_this","that","connect","newCoords","update","info","then","sessionId","_sessionId","uiconfig","uiConfig","_uiConfig","data","speakerData","_speakerData","assetData","_assetData","_this2","firstPlayCallback","waitForInitialGeolocation","initialCoordinates","play","pause","kill","replay","skip","tagIdStr","tag_ids","audioData","fileName","Promise","reject","envelope","Envelope","upload","baseServerUrl","_jQuery","jQuery","path","method","contentType","send","url","assign","timeout","JSON","stringify","mode","deferred","Deferred","promise","ajax","resolve","fail","jqXHR","textStatus","errorThrown","techMsg","usrMsg","error","authToken","ajaxSetup","headers","Authorization","newProjectId","projectName","_envelopeId","_assetId","session_id","post","id","formData","FormData","coordinates","getLastCoords","console","log","append","latitude","longitude","processData","patch","defaultCoords","fastGeolocationPositionOptions","enableHighAccuracy","accurateGeolocationPositionOptions","_navigator","_initialGeolocationPromise","_lastCoords","geolocation","geoUpdateCallback","getCurrentPosition","initialPosition","coords","geoWatchId","watchPosition","updatedPosition","warn","message","code","pubDate","audioFormat","pub_date","audio_format","recordingRadius","recording_radius","location","maxRecordingLength","max_recording_length","clientSystem","geoListenEnablement","userAgent","slice","requestData","project_id","geo_listen_enabled","client_system","defaultHeartbeatIntervalSeconds","heartbeatIntervalId","_streamId","_heartbeatInterval","heartbeatIntervalSeconds","_streamApiPath","initialLocation","streamAudioUrl","resumePlayingPath","createStreamData","streamConnectionPromise","cache","streamData","_streamAudioUrl","stream_url","stream_id","_heartbeatUrl","heartbeatData","setInterval","pausePlayingPath","updateStreamData","tagIds","listener_range_max","listener_range_min","clearInterval","killPlayingPath","replayPlayingPath","skipPlayingPath","deviceId","clientType","userName","device_id","client_type","username","setAuthToken","token","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","definition","realMethod","methodName","undefinedType","bindMethod","noop","bind","Function","e","apply","enableLoggingWhenConsoleArrives","level","loggerName","replaceLoggingMethods","logMethods","methodFactory","defaultMethodFactory","Logger","defaultLevel","persistLevelIfPossible","levelNum","levelName","toUpperCase","localStorage","storageKey","ignore","document","cookie","encodeURIComponent","getPersistedLevel","storedLevel","indexOf","exec","self","levels","currentLevel","TRACE","DEBUG","INFO","WARN","ERROR","SILENT","getLevel","setLevel","persist","enableAll","disableAll","initialLevel","defaultLogger","_loggersByName","getLogger","_log","noConflict","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","setTimeout","runClearTimeout","marker","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","len","run","Item","array","nextTick","args","Array","push","title","browser","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"roundware.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Roundware\"] = factory();\n\telse\n\t\troot[\"Roundware\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Roundware\"] = factory();\n\telse\n\t\troot[\"Roundware\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 13);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/* unknown exports provided */\n/* all exports used */\n/*!**********************!*\\\n  !*** ./src/shims.js ***!\n  \\**********************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(process) {\n\nvar _loglevel = __webpack_require__(/*! loglevel */ 11);\n\nvar logger = _interopRequireWildcard(_loglevel);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n//logger.disableAll();\n\nif (typeof process !== 'undefined' && process.env.ROUNDWARE_DEBUG === \"true\") {\n  /* istanbul ignore next */\n  logger.setDefaultLevel('debug');\n}\n\nmodule.exports = {\n  logger: logger\n};\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(/*! ./../~/process/browser.js */ 12)))\n\n/***/ }),\n/* 1 */\n/* unknown exports provided */\n/* all exports used */\n/*!**************************!*\\\n  !*** ./src/roundware.js ***!\n  \\**************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _project = __webpack_require__(/*! ./project */ 6);\n\nvar _session = __webpack_require__(/*! ./session */ 7);\n\nvar _speaker = __webpack_require__(/*! ./speaker */ 8);\n\nvar _geoPosition = __webpack_require__(/*! ./geo-position */ 5);\n\nvar _stream = __webpack_require__(/*! ./stream */ 9);\n\nvar _asset = __webpack_require__(/*! ./asset */ 3);\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nvar _apiClient = __webpack_require__(/*! ./api-client */ 2);\n\nvar _user = __webpack_require__(/*! ./user */ 10);\n\nvar _envelope = __webpack_require__(/*! ./envelope */ 4);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/** This class is the primary integration point between Roundware's server and your application\n    NOTE that we depend on jQuery being injected, because we use its $.ajax function. As browsers\n    evolve and the whatwg-fetch polyfill evolves, we may be able to switch over to using window.fetch\n\n   @example\n   var roundwareServerUrl = \"http://localhost:8888/api/2\";\n   var roundwareProjectId = 1;\n\n   var roundware = new Roundware(window,{\n     serverUrl: roundwareServerUrl,\n     projectId: roundwareProjectId\n   });\n\n   function ready() {\n     console.info(\"Connected to Roundware Server. Ready to play.\");\n     // this is a good place to initialize audio player controls, etc.\n   }\n\n   // Generally we throw user-friendly messages and log a more technical message\n   function handleError(userErrMsg) {\n     console.error(\"Roundware Error: \" + userErrMsg);\n   }\n\n  roundware.connect().\n    then(ready).\n    catch(handleError);\n\n  function startListening(streamURL) {\n    console.info(\"Loading \" + streamURL);\n    // good place to connect your audio player to the audio stream\n  }\n\n  roundware.play(startListening).catch(handleError);\n**/\nvar Roundware = function () {\n  /** Initialize a new Roundware instance\n   * @param {Object} window - representing the context in which we are executing - provides references to window.navigator, window.console, etc.\n   * @param {Object} options - Collection of parameters for configuring this Roundware instance\n   * @param {String} options.serverUrl - identifies the Roundware server\n   * @param {Number} options.projectId - identifies the Roundware project to connect\n   * @param {Boolean} options.geoListenEnabled - whether or not to attempt to initialize geolocation-based listening\n   * @throws Will throw an error if serveUrl or projectId are missing **/\n  function Roundware(window) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Roundware);\n\n    this._serverUrl = options.serverUrl;\n    this._projectId = options.projectId;\n    this._speakerFilters = options.speakerFilters;\n    this._assetFilters = options.assetFilters;\n\n    if (this._serverUrl === undefined) {\n      throw \"Roundware objects must be initialized with a serverUrl\";\n    }\n\n    if (this._projectId === undefined) {\n      throw \"Roundware objects must be initialized with a projectId\";\n    }\n\n    this._apiClient = new _apiClient.ApiClient(window, this._serverUrl);\n    options.apiClient = this._apiClient;\n\n    var navigator = window.navigator;\n\n    this._user = options.user || new _user.User(options);\n    this._geoPosition = options.geoPosition || new _geoPosition.GeoPosition(navigator, options);\n    this._session = options.session || new _session.Session(navigator, this._projectId, this._geoPosition.geoListenEnabled, options);\n    this._project = options.project || new _project.Project(this._projectId, options);\n    this._stream = options.stream || new _stream.Stream(options);\n    this._speaker = options.speaker || new _speaker.Speaker(this._projectId, options);\n    this._asset = options.asset || new _asset.Asset(this._projectId, options);\n  }\n\n  /** Initiate a connection to Roundware\n   *  @return {Promise} - Can be resolved in order to get the audio stream URL, or rejected to get an error message; see example above **/\n\n\n  _createClass(Roundware, [{\n    key: \"connect\",\n    value: function connect() {\n      var _this = this;\n\n      var that = this;\n\n      this._geoPosition.connect(function (newCoords) {\n        // want to start this process as soon as possible, as it can take a few seconds\n        that._stream.update(newCoords);\n      });\n\n      _shims.logger.info(\"Initializing Roundware for project ID #\" + this._projectId);\n\n      return this._user.connect().then(this._session.connect).then(function (sessionId) {\n        return _this._project.connect(sessionId);\n      }).then(function (sessionId) {\n        return _this._sessionId = sessionId;\n      }).then(this._project.uiconfig).then(function (uiConfig) {\n        return _this._uiConfig = uiConfig;\n      }).then(function (data) {\n        return _this._speaker.connect(_this._speakerFilters);\n      }).then(function (speakerData) {\n        return _this._speakerData = speakerData;\n      }).then(function (data) {\n        return _this._asset.connect(_this._assetFilters);\n      }).then(function (assetData) {\n        return _this._assetData = assetData;\n      });\n    }\n\n    /** Create or resume the audio stream\n     * @see Stream.play **/\n\n  }, {\n    key: \"play\",\n    value: function play() {\n      var _this2 = this;\n\n      var firstPlayCallback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n\n      return this._geoPosition.waitForInitialGeolocation().then(function (initialCoordinates) {\n        return _this2._stream.play(_this2._sessionId, initialCoordinates, firstPlayCallback);\n      });\n    }\n\n    /** Tell Roundware server to pause the audio stream. You should always call this when the local audio player has been paused.\n     * @see Stream.pause **/\n\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      this._stream.pause();\n    }\n\n    /** Tell Roundware server to kill the audio stream.\n     * @see Stream.kill **/\n\n  }, {\n    key: \"kill\",\n    value: function kill() {\n      this._stream.kill();\n    }\n\n    /** Tell Roundware server to replay the current asset.\n     * @see Stream.replay **/\n\n  }, {\n    key: \"replay\",\n    value: function replay() {\n      this._stream.replay();\n    }\n\n    /** Tell Roundware server to skip the current asset.\n     * @see Stream.skip **/\n\n  }, {\n    key: \"skip\",\n    value: function skip() {\n      this._stream.skip();\n    }\n\n    /** Update the Roundware stream with new tag IDs\n     * @param {string} tagIdStr - comma-separated list of tag IDs to send to the streams API **/\n\n  }, {\n    key: \"tags\",\n    value: function tags(tagIdStr) {\n      this._stream.update({ tag_ids: tagIdStr });\n    }\n\n    /** Update the Roundware stream with new tag IDs and or geo-position\n     * @param {object} data - containing keys latitude, longitude and tagIds **/\n\n  }, {\n    key: \"update\",\n    value: function update() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      // Object.keys(data).map(e => console.log(`key=${e}  value=${data[e]}`));\n      this._stream.update(data);\n    }\n\n    /** Attach new assets to the project\n     * @param {Object} audioData - the binary data from a recording to be saved as an asset\n     * @param {string} fileName - name of the file\n     * @return {promise} - represents the API calls to save an asset; can be tested to find out whether upload was successful\n     * @see Envelope.upload */\n\n  }, {\n    key: \"saveAsset\",\n    value: function saveAsset(audioData, fileName, data) {\n      if (!this._sessionId) {\n        return Promise.reject(\"can't save assets without first connecting to the server\");\n      }\n\n      var envelope = new _envelope.Envelope(this._sessionId, this._apiClient, this._geoPosition);\n\n      return envelope.connect().then(function () {\n        envelope.upload(audioData, fileName, data);\n      });\n    }\n  }]);\n\n  return Roundware;\n}();\n\n// Slight hack here to export Roundware module to browser properly; see https://github.com/webpack/webpack/issues/3929\n\n\nmodule.exports = Roundware;\n\n/***/ }),\n/* 2 */\n/* unknown exports provided */\n/* all exports used */\n/*!***************************!*\\\n  !*** ./src/api-client.js ***!\n  \\***************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ApiClient = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Handles HTTP interactions with the Roundware API server, v2.\n// NOTE: Every HTTP method except \".get()\" will cause most browsers to issue a preflight requirements check to the server via the OPTIONS verb,\n// to verify CORS will allow the response to load in the browser. Sometimes this OPTIONS call can get obscured in debugging tools.\n// @see http://roundware.org/docs/terminology/index.html\nvar ApiClient = exports.ApiClient = function () {\n  /** Create a new ApiClient\n   * @param {Object} window - representing the context in which we are executing - provides reference to window.jQuery.ajax()\n   * @param {String} baseServerUrl - identifies the Roundware server to receive API requests\n   * @param {Boolean} [options.fetch = fetch] - for testing purposes, you can inject the fetch mechanism to use for making network requests **/\n  function ApiClient(window, baseServerUrl) {\n    _classCallCheck(this, ApiClient);\n\n    this._jQuery = window.jQuery;\n    this._serverUrl = baseServerUrl;\n  }\n\n  /** Make a GET request to the Roundware server\n   * @param {String} path - the path for your API request, such as \"/streams/\"\n   * @param {Object} options - see the \"send\" method\n   * @see {send} **/\n\n\n  _createClass(ApiClient, [{\n    key: \"get\",\n    value: function get(path, data) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      options.method = \"GET\";\n      options.contentType = 'x-www-form-urlencoded';\n      return this.send(path, data, options);\n    }\n\n    /** Make a POST request to the Roundware server\n     * @param {String} path - the path for your API request, such as \"/streams/\"\n     * @param {Object} options - see the \"send\" method\n     * @see {send} **/\n\n  }, {\n    key: \"post\",\n    value: function post(path, data) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      options.method = \"POST\";\n      return this.send(path, data, options);\n    }\n\n    /** Make a PATCH request to the Roundware server\n     * @param {String} path - the path for your API request, such as \"/streams/\"\n     * @param {Object} options - see the \"send\" method\n     * @see {send} **/\n\n  }, {\n    key: \"patch\",\n    value: function patch(path, data) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      options.method = \"PATCH\";\n      return this.send(path, data, options);\n    }\n\n    /** Transmit an Ajax request to the Roundware API. Note that the Roundware Server expects paths to end with a trailing slash: /sessions/ instead of /sessions\n     * @param path {string} - identifies the endpoint to receive the request\n     * @param data {object} - the payload to send\n     * @param options {object} - any additional options to add to the Ajax request\n     * @return {Promise} - will resolve or reject depending on the status of the request\n     * @todo might be a good place to implement exponential retry of certain types of errors\n     * **/\n\n  }, {\n    key: \"send\",\n    value: function send(path, data) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      var url = this._serverUrl + path;\n\n      options = Object.assign({}, options);\n\n      if (!options.timeout) {\n        options.timeout = 30000; // 30 seconds, arbitrary\n      }\n\n      // If you specify a contentType, we assume you already have formatted your data\n      if (options.contentType === 'multipart/form-data') {\n        // multipart/form-data requires special treatment with jquery.ajax\n        // in order to properly format the POST data\n        options.data = data;\n        options.contentType = false;\n      } else if (options.contentType === 'x-www-form-urlencoded') {\n        options.data = data;\n      } else {\n        // If you don't specify a contentType, we assume you want us to convert your payload to JSON\n        options.contentType = 'application/json';\n        options.data = JSON.stringify(data);\n      }\n\n      options.mode = \"no-cors\";\n\n      var deferred = this._jQuery.Deferred();\n\n      var promise = deferred.promise();\n\n      this._jQuery.ajax(url, options).then(function (data) {\n        return deferred.resolve(data);\n      }).fail(function (jqXHR, textStatus, errorThrown) {\n        var techMsg = textStatus + \": \" + errorThrown;\n        var usrMsg = \"We were unable to contact the audio server due to a network problem; please try again: '\" + techMsg + \"'\";\n        _shims.logger.error(techMsg, jqXHR);\n        deferred.reject(usrMsg);\n      });\n\n      return promise;\n    }\n\n    /** Set the authorization token to use as the header for future API requests. Most Roundware API calls require an auth token to be set.\n     * @param {String} authToken - characters to use in the authorization header **/\n\n  }, {\n    key: \"setAuthToken\",\n    value: function setAuthToken(authToken) {\n      this._jQuery.ajaxSetup({\n        headers: { \"Authorization\": \"token \" + authToken }\n      });\n    }\n  }]);\n\n  return ApiClient;\n}();\n\n/***/ }),\n/* 3 */\n/* unknown exports provided */\n/* all exports used */\n/*!**********************!*\\\n  !*** ./src/asset.js ***!\n  \\**********************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Asset = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar projectId, apiClient;\n\nvar Asset = exports.Asset = function () {\n  function Asset(newProjectId, options) {\n    _classCallCheck(this, Asset);\n\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  _createClass(Asset, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Roundware Assets '\" + projectName + \"' (#\" + projectId + \")\";\n    }\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var path = \"/assets/\";\n      // add project_id to any incoming filter data\n      data['project_id'] = projectId;\n\n      return apiClient.get(path, data).then(function connectionSuccess(data) {\n        return data;\n      });\n    }\n  }]);\n\n  return Asset;\n}();\n\n/***/ }),\n/* 4 */\n/* unknown exports provided */\n/* all exports used */\n/*!*************************!*\\\n  !*** ./src/envelope.js ***!\n  \\*************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Envelope = exports.Envelope = function () {\n  /** Create an Envelope\n   * @param {number} sessionId - identifies the session associated with this asset\n   * @param {ApiClient} apiClient - the API client object to use for server API calls\n   * @param {geoPosition} geoPosition -\n   **/\n  function Envelope(sessionId, apiClient, geoPosition) {\n    _classCallCheck(this, Envelope);\n\n    this._envelopeId = \"(unknown)\";\n    this._sessionId = sessionId;\n    this._apiClient = apiClient;\n    this._geoPosition = geoPosition;\n  }\n\n  /** @returns {String} human-readable representation of this asset **/\n\n\n  _createClass(Envelope, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Envelope \" + this._assetId;\n    }\n\n    /** Create a new Envelope in the server to which we can attach audio recordings as assets\n     * @returns {Promise} represents the pending API call **/\n\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var _this = this;\n\n      var data = {\n        session_id: this._sessionId\n      };\n\n      return this._apiClient.post(\"/envelopes/\", data).then(function (data) {\n        _this._envelopeId = data.id;\n      });\n    }\n\n    /** Sends an audio file to the server\n     * @param {blob} audioData\n     * @param {string} fileName - name of the file\n     * @return {Promise} - represents the API call */\n\n  }, {\n    key: \"upload\",\n    value: function upload(audioData, fileName) {\n      var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n      if (!this._envelopeId) {\n        return Promise.reject(\"cannot upload audio without first connecting this envelope to the server\");\n      }\n\n      var formData = new FormData();\n      var coordinates = this._geoPosition.getLastCoords();\n      console.log(coordinates);\n\n      formData.append('session_id', this._sessionId);\n      formData.append('file', audioData);\n      formData.append('latitude', coordinates.latitude);\n      formData.append('longitude', coordinates.longitude);\n\n      if ('tag_ids' in data) {\n        formData.append('tag_ids', data.tag_ids);\n      }\n\n      var path = \"/envelopes/\" + this._envelopeId + \"/\";\n\n      console.info(\"Uploading \" + fileName + \" to envelope \" + path);\n\n      var options = {\n        contentType: 'multipart/form-data',\n        processData: false\n      };\n\n      return this._apiClient.patch(path, formData, options).then(function (data) {\n        console.info(\"UPLOADDATA\", data);\n      });\n    }\n  }]);\n\n  return Envelope;\n}();\n\n/***/ }),\n/* 5 */\n/* unknown exports provided */\n/* all exports used */\n/*!*****************************!*\\\n  !*** ./src/geo-position.js ***!\n  \\*****************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GeoPosition = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar initialGeoTimeoutSeconds = 1;\n\nvar defaultCoords = {\n  latitude: 1,\n  longitude: 1\n};\n\n// for an initial rapid, low-accuracy position\nvar fastGeolocationPositionOptions = {\n  enableHighAccuracy: false,\n  timeout: initialGeoTimeoutSeconds\n};\n\n// subsequent position monitoring should be high-accuracy\nvar accurateGeolocationPositionOptions = {\n  enableHighAccuracy: true\n};\n\n/** Responsible for tracking the user's position, when geo listening is enabled and the browser is capable\n * @property {Boolean} geoListenEnabled - whether or not the geo positioning system is enabled and available\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation **/\n\nvar GeoPosition = exports.GeoPosition = function () {\n  /** Create a new GeoPosition.\n   * @param {Object} navigator - provides access to geolocation system\n   * @param {Object} options - parameters for initializing this GeoPosition\n   * @param {Boolean} [options.geoListenEnabled = false] - whether or not to attempt to use geolocation **/\n  function GeoPosition(navigator) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, GeoPosition);\n\n    this._navigator = navigator;\n    this._initialGeolocationPromise = Promise.resolve(defaultCoords);\n    this._lastCoords = defaultCoords;\n\n    if (this._navigator.geolocation && options.geoListenEnabled) {\n      this.geoListenEnabled = true;\n    } else {\n      this.geoListenEnabled = false;\n    }\n  }\n\n  /** @return {String} Human-readable representation of this GeoPosition **/\n\n\n  _createClass(GeoPosition, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"GeoPosition (enabled: \" + this.geoListenEnabled + \")\";\n    }\n\n    /** @return {Object} coordinates - last known coordinates received from the geolocation system (defaults to latitude 1, longitude 1) **/\n\n  }, {\n    key: \"getLastCoords\",\n    value: function getLastCoords() {\n      return this._lastCoords;\n    }\n\n    /** Attempts to get an initial rough geographic location for the listener, then sets up a callback\n     * to update the position.\n     * @param {Function} geoUpdateCallback - object that should receive geolocation coordinate updates\n     * @see geoListenEnabled **/\n\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var _this = this;\n\n      var geoUpdateCallback = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : function () {};\n\n      if (!this.geoListenEnabled) {\n        _shims.logger.info(\"Geolocation disabled\");\n        this._initialGeolocationPromise = Promise.resolve({});\n        return;\n      }\n\n      _shims.logger.info(\"Initializing geolocation system\");\n\n      this._initialGeolocationPromise = new Promise(function (resolve, reject) {\n        _this._navigator.geolocation.getCurrentPosition(function (initialPosition) {\n          var coords = initialPosition.coords;\n          _shims.logger.info(\"Received initial geolocation\", coords);\n          geoUpdateCallback(coords);\n          _this._lastCoords = coords;\n\n          var geoWatchId = _this._navigator.geolocation.watchPosition(function (updatedPosition) {\n            var newCoords = updatedPosition.coords;\n            geoUpdateCallback(newCoords);\n            _this._lastCoords = coords;\n          }, function (error) {\n            _shims.logger.warn(\"Unable to watch position: \" + error.message + \" (code #\" + error.code + \")\");\n          }, accurateGeolocationPositionOptions);\n\n          _shims.logger.info(\"Monitoring geoposition updates (watch ID \" + geoWatchId + \")\");\n          resolve(coords);\n        }, function initialGeoError(error) {\n          _shims.logger.warn(\"Unable to get initial geolocation: \" + error.message + \" (code #\" + error.code + \")\");\n          resolve(defaultCoords);\n        }, fastGeolocationPositionOptions);\n      });\n    }\n\n    /** Allows you to wait on the progress of the .connect() behavior, attempting to get an initial\n     * estimate of the user's position. Note that this promise will never fail - if we cannot get an\n     * accurate estimate, we fall back to default coordinates (currently latitude 1, longitude 1)\n     * @return {Promise} Represents the attempt to get an initial estimate of the user's position **/\n\n  }, {\n    key: \"waitForInitialGeolocation\",\n    value: function waitForInitialGeolocation() {\n      return this._initialGeolocationPromise;\n    }\n  }]);\n\n  return GeoPosition;\n}();\n\n/***/ }),\n/* 6 */\n/* unknown exports provided */\n/* all exports used */\n/*!************************!*\\\n  !*** ./src/project.js ***!\n  \\************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Project = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar projectId, apiClient;\nvar projectName = \"(unknown)\";\nvar pubDate, audioFormat, recordingRadius, location, geoListenEnabled;\n\nvar Project = exports.Project = function () {\n  function Project(newProjectId, options) {\n    _classCallCheck(this, Project);\n\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  _createClass(Project, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Roundware Project '\" + projectName + \"' (#\" + projectId + \")\";\n    }\n\n    // getRecordingRadius() {\n    //   return recordingRadius;\n    // }\n\n  }, {\n    key: \"connect\",\n    value: function connect(sessionId) {\n      var path = \"/projects/\" + projectId + \"/\";\n\n      var data = {\n        session_id: sessionId\n      };\n\n      var that = this;\n\n      return apiClient.get(path, data).then(function connectionSuccess(data) {\n        projectName = data.name;\n        pubDate = data.pub_date;\n        audioFormat = data.audio_format;\n        that.recordingRadius = data.recording_radius;\n        that.location = { \"latitude\": data.latitude,\n          \"longitude\": data.longitude };\n        that.maxRecordingLength = data.max_recording_length;\n        return sessionId;\n      });\n    }\n  }, {\n    key: \"uiconfig\",\n    value: function uiconfig(sessionId) {\n      var path = \"/projects/\" + projectId + \"/uiconfig/\";\n\n      var data = {\n        session_id: sessionId\n      };\n\n      return apiClient.get(path, data).then(function connectionSuccess(data) {\n        // let this._uiConfig = data;\n        return data;\n      });\n    }\n  }]);\n\n  return Project;\n}();\n\n/***/ }),\n/* 7 */\n/* unknown exports provided */\n/* all exports used */\n/*!************************!*\\\n  !*** ./src/session.js ***!\n  \\************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Session = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar clientSystem = \"Unknown\";\nvar projectId, sessionId, geoListenEnabled;\nvar apiClient = {};\n\n/** Responsible for establishing a session with the Roundware server **/\n\nvar Session = exports.Session = function () {\n  /** Create a new Session\n   * @param {object} navigator - provides access to the userAgent string\n   * @param {Number} newProjectId - identifies the Roundware project to associate with this session\n   * @param {Boolean} geoListenEnablement - whether the server should enable geo listening features\n   * @param {Object} options - Various configuration parameters for this session\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n  **/\n  function Session(navigator, newProjectId, geoListenEnablement, options) {\n    _classCallCheck(this, Session);\n\n    clientSystem = navigator.userAgent;\n\n    if (clientSystem.length > 127) {\n      // on mobile browsers, this string is longer than the server wants\n      clientSystem = clientSystem.slice(0, 127);\n    }\n\n    projectId = newProjectId;\n    geoListenEnabled = geoListenEnablement;\n\n    apiClient = options.apiClient;\n  }\n\n  /** @returns {String} human-readable representation of this session **/\n\n\n  _createClass(Session, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Roundware Session #\" + sessionId;\n    }\n\n    /** Make an asynchronous API call to establish a session with the Roundware server\n     * @return {Promise} represents the pending API call\n     **/\n\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var requestData = {\n        project_id: projectId,\n        geo_listen_enabled: geoListenEnabled,\n        client_system: clientSystem\n      };\n\n      return apiClient.post(\"/sessions/\", requestData).then(function (data) {\n        sessionId = data.id;\n        return sessionId;\n      });\n    }\n  }]);\n\n  return Session;\n}();\n\n/***/ }),\n/* 8 */\n/* unknown exports provided */\n/* all exports used */\n/*!************************!*\\\n  !*** ./src/speaker.js ***!\n  \\************************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Speaker = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar projectId, apiClient;\n\nvar Speaker = exports.Speaker = function () {\n  function Speaker(newProjectId, options) {\n    _classCallCheck(this, Speaker);\n\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  _createClass(Speaker, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Roundware Speaker '\" + projectName + \"' (#\" + projectId + \")\";\n    }\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var path = \"/speakers/\";\n      // add project_id to any incoming filter data\n      data['project_id'] = projectId;\n\n      return apiClient.get(path, data).then(function connectionSuccess(data) {\n        return data;\n      });\n    }\n  }]);\n\n  return Speaker;\n}();\n\n/***/ }),\n/* 9 */\n/* unknown exports provided */\n/* all exports used */\n/*!***********************!*\\\n  !*** ./src/stream.js ***!\n  \\***********************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Stream = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar defaultHeartbeatIntervalSeconds = 60;\nvar heartbeatIntervalId = void 0;\n\n/** Establishes an audio stream with the Roundware server, and notifies Roundware of events like tag\n * and geoposition updates\n * @todo skip/ - causes currently playing asset to fade out and next available asset in playlist to begin playing thereafter\n * @todo playasset/ - causes currently playing asset to fade out and asset specified by asset_id param is played thereafter\n * @todo replayasset/ - causes currently playing asset to fade out and start playing again\n * @todo pause/ - causes currently playing asset to fade out and prevents any further assets from being added to the stream (though the playlist continues to be updated per PATCH calls)\n * @todo resume/ - un-does pause by allowing assets to be added to stream again from the playlist\n * **/\n\nvar Stream = exports.Stream = function () {\n  /** Create a new Stream\n   * @param {Object} options - Various configuration parameters for this stream\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n   * @param {Number} [options.heartbeatIntervalSeconds = 60\"] how frequently to send a stream heartbeat\n   **/\n  function Stream(options) {\n    _classCallCheck(this, Stream);\n\n    this._apiClient = options.apiClient;\n    this._streamId = \"(unknown)\";\n    this._heartbeatInterval = (options.heartbeatIntervalSeconds || defaultHeartbeatIntervalSeconds) * 1000;\n  }\n\n  /** @returns {String} human-readable description of this stream **/\n\n\n  _createClass(Stream, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"Roundware Stream #\" + this._streamId + \" (\" + this._streamApiPath + \")\";\n    }\n\n    /** Request a streaming audio URL from Roundware server and establish a regular heartbeat. The heartbeat is used to keep a stream alive\n     * during a session. Streams take a lot of resources on the server, so we put the auto-kill mechanism in place to not have useless\n     * streams taking resources, but needed a method to keep them alive when we know they are still wanted. After we initially connect to Roundware,\n     * subsequent calls are forwarded to the Roundware server as \"resume playing\" API messages.\n     * @param {Number} sessionId - Identifies the current session, must have been previously established by an instance of the Session class\n     * @param {Promise}  initialGeoLocation - we will wait on this promise to resolve with initial coordinates before attempting to establish a stream\n     * @param {Stream~firstPlayCallback} firstPlayCallback - invoked the first time we connect to roundware and retrieve a stream URL\n     * @returns {Promise} represents the pending API call\n     * @see pause()\n     * **/\n\n  }, {\n    key: \"play\",\n    value: function play(sessionId, initialLocation) {\n      var _this = this;\n\n      var firstPlayCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (streamAudioUrl) {};\n\n      if (this._streamApiPath) {\n        var resumePlayingPath = this._streamApiPath + \"resume/\";\n        return this._apiClient.post(resumePlayingPath);\n      }\n\n      this._sessionId = sessionId;\n\n      // Object.assign(createStreamData,initialLocation,{ session_id: this._sessionId });\n\n      var createStreamData = new FormData();\n\n      createStreamData.append('session_id', this._sessionId);\n      createStreamData.append('latitude', initialLocation.latitude); // marker.position.lat());\n      createStreamData.append('longitude', initialLocation.longitude); //marker.position.lng());\n      console.log(createStreamData.get('session_id'));\n\n      var streamConnectionPromise = this._apiClient.post(\"/streams/\", createStreamData, {\n        cache: true, // to avoid CORS problems TODO remove this\n        processData: false,\n        contentType: 'multipart/form-data'\n      });\n\n      streamConnectionPromise.then(function (streamData) {\n        _this._streamAudioUrl = streamData.stream_url;\n        _this._streamId = streamData.stream_id;\n        _this._streamApiPath = \"/streams/\" + _this._streamId + \"/\";\n\n        _this._heartbeatUrl = \"/streams/\" + _this._streamId + \"/heartbeat/\";\n\n        var heartbeatData = {\n          session_id: _this._sessionId\n        };\n\n        firstPlayCallback(_this._streamAudioUrl);\n\n        heartbeatIntervalId = setInterval(function () {\n          _this._apiClient.post(_this._heartbeatUrl, heartbeatData);\n        }, _this._heartbeatInterval);\n      });\n\n      return streamConnectionPromise;\n    }\n\n    /** Tells Roundware server to pause the audio stream - you should always call this when pausing\n     * local playback, to avoid wasting server resources **/\n\n  }, {\n    key: \"pause\",\n    value: function pause() {\n      if (this._streamAudioUrl) {\n        var pausePlayingPath = this._streamApiPath + \"pause/\";\n        this._apiClient.post(pausePlayingPath);\n      }\n    }\n\n    /** Sends data to the Roundware server. If the Stream has not been established, does nothing. Can use a list of tag_ids or a position (lat/lon) to filter the assets available to the stream.\n     * Typically for a normal geo-listen project, the position PATCH calls are triggered automatically by the client’s GPS/location system: every time a new position is registered by the client,\n     * a PATCH call is sent to let the server know and the server acts accordingly by adjusting the underlying music mix as well as modifying the playlist of available assets to be played.\n     * @param {Object} data [{}]\n     * **/\n\n  }, {\n    key: \"update\",\n    value: function update() {\n      var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      if (this._streamApiPath) {\n        var updateStreamData = new FormData();\n\n        updateStreamData.append('session_id', this._sessionId);\n        updateStreamData.append('latitude', data.latitude);\n        updateStreamData.append('longitude', data.longitude);\n        updateStreamData.append('tag_ids', data.tagIds);\n        if ('listener_range_max' in data) {\n          updateStreamData.append('listener_range_max', data.listener_range_max);\n        }\n        if ('listener_range_min' in data) {\n          updateStreamData.append('listener_range_min', data.listener_range_min);\n        }\n\n        data.session_id = this._sessionId;\n        return this._apiClient.patch(this._streamApiPath, updateStreamData, {\n          cache: true, // to avoid CORS problems TODO remove this\n          processData: false,\n          contentType: 'multipart/form-data'\n        });\n      }\n    }\n\n    /** Tells Roundware server to kill the audio stream **/\n\n  }, {\n    key: \"kill\",\n    value: function kill() {\n      clearInterval(heartbeatIntervalId);\n      if (this._streamAudioUrl) {\n        var killPlayingPath = this._streamApiPath + \"kill/\";\n        this._apiClient.post(killPlayingPath);\n      }\n    }\n\n    /** Tells Roundware server to replay the current asset **/\n\n  }, {\n    key: \"replay\",\n    value: function replay() {\n      if (this._streamAudioUrl) {\n        var replayPlayingPath = this._streamApiPath + \"replayasset/\";\n        this._apiClient.post(replayPlayingPath);\n      }\n    }\n\n    /** Tells Roundware server to skip the current asset **/\n\n  }, {\n    key: \"skip\",\n    value: function skip() {\n      if (this._streamAudioUrl) {\n        var skipPlayingPath = this._streamApiPath + \"skipasset/\";\n        this._apiClient.post(skipPlayingPath);\n      }\n    }\n  }]);\n\n  return Stream;\n}();\n\n/**\n * This callback is invoked by play() the first time we connect to Roundware and get an audio stream URL\n * @callback Streamam~firstPlayCallback\n * @param {string} streamAudioUrl - the URL of the stream, ready to connect to an audio source for playback\n */\n\n/***/ }),\n/* 10 */\n/* unknown exports provided */\n/* all exports used */\n/*!*********************!*\\\n  !*** ./src/user.js ***!\n  \\*********************/\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.User = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _shims = __webpack_require__(/*! ./shims */ 0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar deviceId, clientType, userName, apiClient;\nvar authToken = \"UNKNOWN\";\nvar userName = \"(anonymous)\";\n\n/** Responsible for identifying the user to the Roundware server and retrieving an auth token **/\n\nvar User = exports.User = function () {\n  /** Create a User\n   * @param {Object} options - Various configuration parameters for this user\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n   * @param {String} options.deviceId - this value distinguishes a particular user, who may be anonymous, to the server; by default we will fingerprint the browser to get this value, but you can supply your own value (useful if your app has a preexisting authorization scheme)\n   * @param {String} [options.clientType = \"web\"] \n   **/\n  function User(options) {\n    _classCallCheck(this, User);\n\n    apiClient = options.apiClient;\n\n    // TODO need to try to persist deviceId as a random value that can partially serve as \"a unique identifier generated by the client\" that can \n    // used to claim a anonymous user's contributions. Some ideas for implementation: https://clientjs.org/ and https://github.com/Valve/fingerprintjs2\n    deviceId = options.deviceId || \"00000000000000\";\n    clientType = options.clientType || \"web\";\n  }\n\n  /** @returns {String} human-readable representation of this user **/\n\n\n  _createClass(User, [{\n    key: \"toString\",\n    value: function toString() {\n      return \"User \" + userName + \" (deviceId \" + deviceId + \")\";\n    }\n\n    /** Make an API call to associate the (possibly anonymous) application user with a Roundware user account.\n     * Upon success, this function receives an auth token, which is passed onto the apiClient object.\n     * @returns {Promise} represents the pending API call **/\n\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var data = {\n        device_id: deviceId,\n        client_type: clientType\n      };\n\n      // TODO need to also handle auth failures\n      return apiClient.post(\"/users/\", data).then(function (data) {\n        userName = data.username;\n        apiClient.setAuthToken(data.token);\n      });\n    }\n  }]);\n\n  return User;\n}();\n\n/***/ }),\n/* 11 */\n/* unknown exports provided */\n/* all exports used */\n/*!************************************!*\\\n  !*** ./~/loglevel/lib/loglevel.js ***!\n  \\************************************/\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (true) {\n        !(__WEBPACK_AMD_DEFINE_FACTORY__ = (definition),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :\n\t\t\t\t__WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    function realMethod(methodName) {\n        if (typeof console === undefinedType) {\n            return false; // We can't build a real method without a console to log to\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // these private functions always need `this` to be set properly\n\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n    }\n\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public API\n       *\n       */\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Package-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    return defaultLogger;\n}));\n\n\n/***/ }),\n/* 12 */\n/* unknown exports provided */\n/* all exports used */\n/*!******************************!*\\\n  !*** ./~/process/browser.js ***!\n  \\******************************/\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n/***/ }),\n/* 13 */\n/* unknown exports provided */\n/* all exports used */\n/*!********************************!*\\\n  !*** multi ./src/roundware.js ***!\n  \\********************************/\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(/*! ./src/roundware.js */1);\n\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// roundware.umd.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ed42b3995e5f13b32b13","import * as logger from 'loglevel';\n\n//logger.disableAll();\n\nif ((typeof(process) !== 'undefined' && process.env.ROUNDWARE_DEBUG === \"true\")) {\n  /* istanbul ignore next */\n  logger.setDefaultLevel('debug');\n}\n\nmodule.exports = {\n  logger: logger\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/shims.js","import { Project } from \"./project\";\nimport { Session } from \"./session\";\nimport { Speaker } from \"./speaker\";\nimport { GeoPosition } from \"./geo-position\";\nimport { Stream } from \"./stream\";\nimport { Asset } from \"./asset\";\nimport { logger } from \"./shims\";\nimport { ApiClient } from \"./api-client\";\nimport { User } from \"./user\";\nimport { Envelope } from \"./envelope\";\n\n/** This class is the primary integration point between Roundware's server and your application\n    NOTE that we depend on jQuery being injected, because we use its $.ajax function. As browsers\n    evolve and the whatwg-fetch polyfill evolves, we may be able to switch over to using window.fetch\n\n   @example\n   var roundwareServerUrl = \"http://localhost:8888/api/2\";\n   var roundwareProjectId = 1;\n\n   var roundware = new Roundware(window,{\n     serverUrl: roundwareServerUrl,\n     projectId: roundwareProjectId\n   });\n\n   function ready() {\n     console.info(\"Connected to Roundware Server. Ready to play.\");\n     // this is a good place to initialize audio player controls, etc.\n   }\n\n   // Generally we throw user-friendly messages and log a more technical message\n   function handleError(userErrMsg) {\n     console.error(\"Roundware Error: \" + userErrMsg);\n   }\n\n  roundware.connect().\n    then(ready).\n    catch(handleError);\n\n  function startListening(streamURL) {\n    console.info(\"Loading \" + streamURL);\n    // good place to connect your audio player to the audio stream\n  }\n\n  roundware.play(startListening).catch(handleError);\n**/\nclass Roundware {\n  /** Initialize a new Roundware instance\n   * @param {Object} window - representing the context in which we are executing - provides references to window.navigator, window.console, etc.\n   * @param {Object} options - Collection of parameters for configuring this Roundware instance\n   * @param {String} options.serverUrl - identifies the Roundware server\n   * @param {Number} options.projectId - identifies the Roundware project to connect\n   * @param {Boolean} options.geoListenEnabled - whether or not to attempt to initialize geolocation-based listening\n   * @throws Will throw an error if serveUrl or projectId are missing **/\n  constructor(window,options = {}) {\n    this._serverUrl = options.serverUrl;\n    this._projectId = options.projectId;\n    this._speakerFilters = options.speakerFilters;\n    this._assetFilters = options.assetFilters;\n\n    if (this._serverUrl === undefined) {\n      throw \"Roundware objects must be initialized with a serverUrl\";\n    }\n\n    if (this._projectId === undefined) {\n      throw \"Roundware objects must be initialized with a projectId\";\n    }\n\n    this._apiClient = new ApiClient(window,this._serverUrl);\n    options.apiClient = this._apiClient;\n\n    let navigator = window.navigator;\n\n    this._user        = options.user        || new User(options);\n    this._geoPosition = options.geoPosition || new GeoPosition(navigator,options);\n    this._session     = options.session     || new Session(navigator,this._projectId,this._geoPosition.geoListenEnabled,options);\n    this._project     = options.project     || new Project(this._projectId,options);\n    this._stream      = options.stream      || new Stream(options);\n    this._speaker     = options.speaker     || new Speaker(this._projectId,options);\n    this._asset       = options.asset       || new Asset(this._projectId,options);\n  }\n\n  /** Initiate a connection to Roundware\n   *  @return {Promise} - Can be resolved in order to get the audio stream URL, or rejected to get an error message; see example above **/\n  connect() {\n    let that = this;\n\n    this._geoPosition.connect(function(newCoords) {\n      // want to start this process as soon as possible, as it can take a few seconds\n      that._stream.update(newCoords);\n    });\n\n    logger.info(\"Initializing Roundware for project ID #\" + this._projectId);\n\n    return this._user.connect().\n      then(this._session.connect).\n      then((sessionId) => this._project.connect(sessionId)).\n      then((sessionId) => this._sessionId = sessionId).\n      then(this._project.uiconfig).\n      then((uiConfig) => this._uiConfig = uiConfig).\n      then((data) => this._speaker.connect(this._speakerFilters)).\n      then((speakerData) => this._speakerData = speakerData).\n      then((data) => this._asset.connect(this._assetFilters)).\n      then((assetData) => this._assetData = assetData);\n  }\n\n  /** Create or resume the audio stream\n   * @see Stream.play **/\n  play(firstPlayCallback = () => {}) {\n    return this._geoPosition.waitForInitialGeolocation().then((initialCoordinates) => {\n      return this._stream.play(this._sessionId,initialCoordinates,firstPlayCallback);\n    });\n  }\n\n  /** Tell Roundware server to pause the audio stream. You should always call this when the local audio player has been paused.\n   * @see Stream.pause **/\n  pause() {\n    this._stream.pause();\n  }\n\n  /** Tell Roundware server to kill the audio stream.\n   * @see Stream.kill **/\n  kill() {\n    this._stream.kill();\n  }\n\n  /** Tell Roundware server to replay the current asset.\n   * @see Stream.replay **/\n  replay() {\n    this._stream.replay();\n  }\n\n  /** Tell Roundware server to skip the current asset.\n   * @see Stream.skip **/\n  skip() {\n    this._stream.skip();\n  }\n\n  /** Update the Roundware stream with new tag IDs\n   * @param {string} tagIdStr - comma-separated list of tag IDs to send to the streams API **/\n  tags(tagIdStr) {\n    this._stream.update({ tag_ids: tagIdStr });\n  }\n\n  /** Update the Roundware stream with new tag IDs and or geo-position\n   * @param {object} data - containing keys latitude, longitude and tagIds **/\n  update(data = {}) {\n    // Object.keys(data).map(e => console.log(`key=${e}  value=${data[e]}`));\n    this._stream.update(data);\n  }\n\n  /** Attach new assets to the project\n   * @param {Object} audioData - the binary data from a recording to be saved as an asset\n   * @param {string} fileName - name of the file\n   * @return {promise} - represents the API calls to save an asset; can be tested to find out whether upload was successful\n   * @see Envelope.upload */\n  saveAsset(audioData,fileName,data) {\n    if (!this._sessionId) {\n      return Promise.reject(\"can't save assets without first connecting to the server\");\n    }\n\n    let envelope = new Envelope(this._sessionId,this._apiClient,this._geoPosition);\n\n    return envelope.connect().\n      then(function() {\n        envelope.upload(audioData,fileName,data);\n      });\n  }\n}\n\n// Slight hack here to export Roundware module to browser properly; see https://github.com/webpack/webpack/issues/3929\nmodule.exports = Roundware;\n\n\n\n// WEBPACK FOOTER //\n// ./src/roundware.js","import { logger } from \"./shims\";\n\n// Handles HTTP interactions with the Roundware API server, v2.\n// NOTE: Every HTTP method except \".get()\" will cause most browsers to issue a preflight requirements check to the server via the OPTIONS verb,\n// to verify CORS will allow the response to load in the browser. Sometimes this OPTIONS call can get obscured in debugging tools.\n// @see http://roundware.org/docs/terminology/index.html\nexport class ApiClient {\n  /** Create a new ApiClient\n   * @param {Object} window - representing the context in which we are executing - provides reference to window.jQuery.ajax()\n   * @param {String} baseServerUrl - identifies the Roundware server to receive API requests\n   * @param {Boolean} [options.fetch = fetch] - for testing purposes, you can inject the fetch mechanism to use for making network requests **/\n  constructor(window,baseServerUrl) {\n    this._jQuery = window.jQuery;\n    this._serverUrl = baseServerUrl;\n  }\n\n  /** Make a GET request to the Roundware server\n   * @param {String} path - the path for your API request, such as \"/streams/\"\n   * @param {Object} options - see the \"send\" method\n   * @see {send} **/\n  get(path,data,options = {}) {\n    options.method = \"GET\";\n    options.contentType = 'x-www-form-urlencoded';\n    return this.send(path,data,options);\n  }\n\n  /** Make a POST request to the Roundware server\n   * @param {String} path - the path for your API request, such as \"/streams/\"\n   * @param {Object} options - see the \"send\" method\n   * @see {send} **/\n  post(path,data,options = {}) {\n    options.method = \"POST\";\n    return this.send(path,data,options);\n  }\n\n  /** Make a PATCH request to the Roundware server\n   * @param {String} path - the path for your API request, such as \"/streams/\"\n   * @param {Object} options - see the \"send\" method\n   * @see {send} **/\n  patch(path,data,options = {}) {\n    options.method = \"PATCH\";\n    return this.send(path,data,options);\n  }\n\n  /** Transmit an Ajax request to the Roundware API. Note that the Roundware Server expects paths to end with a trailing slash: /sessions/ instead of /sessions\n   * @param path {string} - identifies the endpoint to receive the request\n   * @param data {object} - the payload to send\n   * @param options {object} - any additional options to add to the Ajax request\n   * @return {Promise} - will resolve or reject depending on the status of the request\n   * @todo might be a good place to implement exponential retry of certain types of errors\n   * **/\n  send(path,data,options = {}) {\n    let url = this._serverUrl + path;\n\n    options = Object.assign({},options);\n\n    if (!options.timeout) {\n      options.timeout = 30000; // 30 seconds, arbitrary\n    }\n\n    // If you specify a contentType, we assume you already have formatted your data\n    if (options.contentType === 'multipart/form-data') {\n      // multipart/form-data requires special treatment with jquery.ajax\n      // in order to properly format the POST data\n      options.data = data;\n      options.contentType = false;\n    } else if (options.contentType === 'x-www-form-urlencoded') {\n      options.data = data;\n    } else {\n      // If you don't specify a contentType, we assume you want us to convert your payload to JSON\n      options.contentType = 'application/json';\n      options.data = JSON.stringify(data);\n    }\n\n    options.mode = \"no-cors\";\n\n    let deferred = this._jQuery.Deferred();\n\n    let promise = deferred.promise();\n\n    this._jQuery.ajax(url,options).\n      then((data) => deferred.resolve(data)).\n      fail((jqXHR,textStatus,errorThrown) => {\n        let techMsg = `${textStatus}: ${errorThrown}`;\n        let usrMsg = `We were unable to contact the audio server due to a network problem; please try again: '${techMsg}'`;\n        logger.error(techMsg,jqXHR);\n        deferred.reject(usrMsg);\n      });\n\n    return promise;\n  }\n\n  /** Set the authorization token to use as the header for future API requests. Most Roundware API calls require an auth token to be set.\n   * @param {String} authToken - characters to use in the authorization header **/\n  setAuthToken(authToken) {\n    this._jQuery.ajaxSetup({\n      headers: { \"Authorization\": `token ${authToken}` }\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api-client.js","import { logger } from \"./shims\";\n\nvar projectId, apiClient;\n\nexport class Asset {\n  constructor(newProjectId,options) {\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  toString() {\n    return `Roundware Assets '${projectName}' (#${projectId})`;\n  }\n\n  connect(data={}) {\n    var path = \"/assets/\";\n    // add project_id to any incoming filter data\n    data['project_id'] = projectId;\n\n    return apiClient.get(path,data).\n      then(function connectionSuccess(data) {\n        return data;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/asset.js","export class Envelope {\n  /** Create an Envelope\n   * @param {number} sessionId - identifies the session associated with this asset\n   * @param {ApiClient} apiClient - the API client object to use for server API calls\n   * @param {geoPosition} geoPosition -\n   **/\n  constructor(sessionId,apiClient,geoPosition) {\n    this._envelopeId = \"(unknown)\";\n    this._sessionId = sessionId;\n    this._apiClient = apiClient;\n    this._geoPosition = geoPosition;\n  }\n\n  /** @returns {String} human-readable representation of this asset **/\n  toString() {\n    return `Envelope ${this._assetId}`;\n  }\n\n  /** Create a new Envelope in the server to which we can attach audio recordings as assets\n   * @returns {Promise} represents the pending API call **/\n  connect() {\n    let data = {\n      session_id: this._sessionId\n    };\n\n    return this._apiClient.post(\"/envelopes/\",data).\n      then((data) => {\n        this._envelopeId = data.id;\n      });\n  }\n\n  /** Sends an audio file to the server\n   * @param {blob} audioData\n   * @param {string} fileName - name of the file\n   * @return {Promise} - represents the API call */\n  upload(audioData,fileName,data={}) {\n    if (!this._envelopeId) {\n      return Promise.reject(\"cannot upload audio without first connecting this envelope to the server\");\n    }\n\n    let formData = new FormData();\n    let coordinates = this._geoPosition.getLastCoords();\n    console.log(coordinates);\n\n    formData.append('session_id',this._sessionId);\n    formData.append('file',audioData);\n    formData.append('latitude',coordinates.latitude);\n    formData.append('longitude',coordinates.longitude);\n\n    if ('tag_ids' in data) {\n      formData.append('tag_ids',data.tag_ids);\n    }\n\n    let path = `/envelopes/${this._envelopeId}/`;\n\n    console.info(`Uploading ${fileName} to envelope ${path}`);\n\n    let options = {\n      contentType: 'multipart/form-data',\n      processData: false\n    };\n\n    return this._apiClient.patch(path,formData,options).\n      then((data) => {\n        console.info(\"UPLOADDATA\",data);\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/envelope.js","import { logger } from \"./shims\";\n\nconst initialGeoTimeoutSeconds = 1;\n\nconst defaultCoords = {\n  latitude: 1,\n  longitude: 1\n};\n\n// for an initial rapid, low-accuracy position\nconst fastGeolocationPositionOptions = {\n  enableHighAccuracy: false,\n  timeout: initialGeoTimeoutSeconds\n};\n\n// subsequent position monitoring should be high-accuracy\nconst accurateGeolocationPositionOptions = {\n  enableHighAccuracy: true\n};\n\n/** Responsible for tracking the user's position, when geo listening is enabled and the browser is capable\n * @property {Boolean} geoListenEnabled - whether or not the geo positioning system is enabled and available\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation **/\nexport class GeoPosition {\n  /** Create a new GeoPosition.\n   * @param {Object} navigator - provides access to geolocation system\n   * @param {Object} options - parameters for initializing this GeoPosition\n   * @param {Boolean} [options.geoListenEnabled = false] - whether or not to attempt to use geolocation **/\n  constructor(navigator,options = {}) {\n    this._navigator = navigator;\n    this._initialGeolocationPromise = Promise.resolve(defaultCoords);\n    this._lastCoords = defaultCoords;\n\n    if (this._navigator.geolocation && options.geoListenEnabled) {\n      this.geoListenEnabled = true;\n    } else {\n      this.geoListenEnabled = false;\n    }\n  }\n\n  /** @return {String} Human-readable representation of this GeoPosition **/\n  toString() {\n    return `GeoPosition (enabled: ${this.geoListenEnabled})`;\n  }\n\n  /** @return {Object} coordinates - last known coordinates received from the geolocation system (defaults to latitude 1, longitude 1) **/\n  getLastCoords() {\n    return this._lastCoords;\n  }\n\n  /** Attempts to get an initial rough geographic location for the listener, then sets up a callback\n   * to update the position.\n   * @param {Function} geoUpdateCallback - object that should receive geolocation coordinate updates\n   * @see geoListenEnabled **/\n  connect(geoUpdateCallback = () => {}) {\n    if (!this.geoListenEnabled) {\n      logger.info(\"Geolocation disabled\");\n      this._initialGeolocationPromise = Promise.resolve({});\n      return;\n    }\n\n    logger.info(\"Initializing geolocation system\");\n\n    this._initialGeolocationPromise = new Promise((resolve,reject) => {\n      this._navigator.geolocation.getCurrentPosition((initialPosition) => {\n        let coords = initialPosition.coords;\n        logger.info(\"Received initial geolocation\",coords);\n        geoUpdateCallback(coords);\n        this._lastCoords = coords;\n\n        let geoWatchId = this._navigator.geolocation.watchPosition((updatedPosition) => {\n          let newCoords = updatedPosition.coords;\n          geoUpdateCallback(newCoords);\n          this._lastCoords = coords;\n        },(error) => {\n          logger.warn(`Unable to watch position: ${error.message} (code #${error.code})`);\n        },accurateGeolocationPositionOptions);\n\n        logger.info(`Monitoring geoposition updates (watch ID ${geoWatchId})`);\n        resolve(coords);\n      },function initialGeoError(error) {\n        logger.warn(`Unable to get initial geolocation: ${error.message} (code #${error.code})`);\n        resolve(defaultCoords);\n      },fastGeolocationPositionOptions);\n    });\n  }\n\n  /** Allows you to wait on the progress of the .connect() behavior, attempting to get an initial\n   * estimate of the user's position. Note that this promise will never fail - if we cannot get an\n   * accurate estimate, we fall back to default coordinates (currently latitude 1, longitude 1)\n   * @return {Promise} Represents the attempt to get an initial estimate of the user's position **/\n  waitForInitialGeolocation() {\n    return this._initialGeolocationPromise;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/geo-position.js","import { logger } from \"./shims\";\n\nvar projectId, apiClient;\nvar projectName = \"(unknown)\";\nvar pubDate, audioFormat, recordingRadius, location, geoListenEnabled;\n\nexport class Project {\n  constructor(newProjectId,options) {\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  toString() {\n    return `Roundware Project '${projectName}' (#${projectId})`;\n  }\n\n  // getRecordingRadius() {\n  //   return recordingRadius;\n  // }\n\n  connect(sessionId) {\n    var path = \"/projects/\" + projectId + \"/\";\n\n    var data = {\n      session_id: sessionId\n    };\n\n    let that = this;\n\n    return apiClient.get(path,data).\n      then(function connectionSuccess(data) {\n        projectName = data.name;\n        pubDate = data.pub_date;\n        audioFormat = data.audio_format;\n        that.recordingRadius = data.recording_radius;\n        that.location = {\"latitude\": data.latitude,\n                         \"longitude\": data.longitude};\n        that.maxRecordingLength = data.max_recording_length;\n        return sessionId;\n      });\n  }\n\n  uiconfig(sessionId) {\n    var path = \"/projects/\" + projectId + \"/uiconfig/\";\n\n    var data = {\n      session_id: sessionId\n    };\n\n    return apiClient.get(path,data).\n      then(function connectionSuccess(data) {\n        // let this._uiConfig = data;\n        return data;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/project.js","import { logger } from \"./shims\";\n\nvar clientSystem = \"Unknown\";\nvar projectId, sessionId, geoListenEnabled;\nvar apiClient = {};\n\n/** Responsible for establishing a session with the Roundware server **/\nexport class Session {\n  /** Create a new Session\n   * @param {object} navigator - provides access to the userAgent string\n   * @param {Number} newProjectId - identifies the Roundware project to associate with this session\n   * @param {Boolean} geoListenEnablement - whether the server should enable geo listening features\n   * @param {Object} options - Various configuration parameters for this session\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n  **/\n  constructor (navigator,newProjectId,geoListenEnablement,options) {\n    clientSystem = navigator.userAgent;\n\n    if (clientSystem.length > 127) {\n      // on mobile browsers, this string is longer than the server wants\n      clientSystem = clientSystem.slice(0,127);\n    }\n\n    projectId = newProjectId;\n    geoListenEnabled = geoListenEnablement;\n\n    apiClient = options.apiClient;\n  }\n\n  /** @returns {String} human-readable representation of this session **/\n  toString() {\n    return \"Roundware Session #\" + sessionId;\n  }\n\n  /** Make an asynchronous API call to establish a session with the Roundware server\n   * @return {Promise} represents the pending API call\n   **/\n  connect() {\n    let requestData = {\n      project_id: projectId,\n      geo_listen_enabled: geoListenEnabled,\n      client_system: clientSystem\n    };\n\n    return apiClient.post(\"/sessions/\",requestData).\n      then((data) => {\n        sessionId = data.id;\n        return sessionId;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/session.js","import { logger } from \"./shims\";\n\nvar projectId, apiClient;\n\nexport class Speaker {\n  constructor(newProjectId,options) {\n    projectId = newProjectId;\n    apiClient = options.apiClient;\n  }\n\n  toString() {\n    return `Roundware Speaker '${projectName}' (#${projectId})`;\n  }\n\n  connect(data={}) {\n    var path = \"/speakers/\";\n    // add project_id to any incoming filter data\n    data['project_id'] = projectId\n\n    return apiClient.get(path,data).\n      then(function connectionSuccess(data) {\n        return data;\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/speaker.js","import { logger } from \"./shims\";\n\nconst defaultHeartbeatIntervalSeconds = 60;\nlet heartbeatIntervalId;\n\n/** Establishes an audio stream with the Roundware server, and notifies Roundware of events like tag\n * and geoposition updates\n * @todo skip/ - causes currently playing asset to fade out and next available asset in playlist to begin playing thereafter\n * @todo playasset/ - causes currently playing asset to fade out and asset specified by asset_id param is played thereafter\n * @todo replayasset/ - causes currently playing asset to fade out and start playing again\n * @todo pause/ - causes currently playing asset to fade out and prevents any further assets from being added to the stream (though the playlist continues to be updated per PATCH calls)\n * @todo resume/ - un-does pause by allowing assets to be added to stream again from the playlist\n * **/\nexport class Stream {\n  /** Create a new Stream\n   * @param {Object} options - Various configuration parameters for this stream\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n   * @param {Number} [options.heartbeatIntervalSeconds = 60\"] how frequently to send a stream heartbeat\n   **/\n  constructor(options) {\n    this._apiClient = options.apiClient;\n    this._streamId = \"(unknown)\";\n    this._heartbeatInterval = (options.heartbeatIntervalSeconds || defaultHeartbeatIntervalSeconds) * 1000;\n  }\n\n  /** @returns {String} human-readable description of this stream **/\n  toString() {\n    return `Roundware Stream #${this._streamId} (${this._streamApiPath})`;\n  }\n\n  /** Request a streaming audio URL from Roundware server and establish a regular heartbeat. The heartbeat is used to keep a stream alive\n   * during a session. Streams take a lot of resources on the server, so we put the auto-kill mechanism in place to not have useless\n   * streams taking resources, but needed a method to keep them alive when we know they are still wanted. After we initially connect to Roundware,\n   * subsequent calls are forwarded to the Roundware server as \"resume playing\" API messages.\n   * @param {Number} sessionId - Identifies the current session, must have been previously established by an instance of the Session class\n   * @param {Promise}  initialGeoLocation - we will wait on this promise to resolve with initial coordinates before attempting to establish a stream\n   * @param {Stream~firstPlayCallback} firstPlayCallback - invoked the first time we connect to roundware and retrieve a stream URL\n   * @returns {Promise} represents the pending API call\n   * @see pause()\n   * **/\n  play(sessionId,initialLocation,firstPlayCallback = (streamAudioUrl) => {}) {\n    if (this._streamApiPath) {\n      let resumePlayingPath = `${this._streamApiPath}resume/`;\n      return this._apiClient.post(resumePlayingPath);\n    }\n\n    this._sessionId = sessionId;\n\n    // Object.assign(createStreamData,initialLocation,{ session_id: this._sessionId });\n\n    let createStreamData = new FormData();\n\n    createStreamData.append('session_id',this._sessionId);\n    createStreamData.append('latitude',initialLocation.latitude); // marker.position.lat());\n    createStreamData.append('longitude',initialLocation.longitude); //marker.position.lng());\n    console.log(createStreamData.get('session_id'));\n\n    let streamConnectionPromise = this._apiClient.post(\"/streams/\",createStreamData,{\n      cache: true, // to avoid CORS problems TODO remove this\n      processData: false,\n      contentType: 'multipart/form-data'\n    });\n\n    streamConnectionPromise.then((streamData) => {\n      this._streamAudioUrl = streamData.stream_url;\n      this._streamId = streamData.stream_id;\n      this._streamApiPath = `/streams/${this._streamId}/`;\n\n      this._heartbeatUrl = `/streams/${this._streamId}/heartbeat/`;\n\n      let heartbeatData = {\n        session_id: this._sessionId\n      };\n\n      firstPlayCallback(this._streamAudioUrl);\n\n      heartbeatIntervalId = setInterval(() => {\n        this._apiClient.post(this._heartbeatUrl,heartbeatData);\n      },this._heartbeatInterval);\n    });\n\n    return streamConnectionPromise;\n  }\n\n  /** Tells Roundware server to pause the audio stream - you should always call this when pausing\n   * local playback, to avoid wasting server resources **/\n  pause() {\n    if (this._streamAudioUrl) {\n      let pausePlayingPath = `${this._streamApiPath}pause/`;\n      this._apiClient.post(pausePlayingPath);\n    }\n  }\n\n  /** Sends data to the Roundware server. If the Stream has not been established, does nothing. Can use a list of tag_ids or a position (lat/lon) to filter the assets available to the stream.\n   * Typically for a normal geo-listen project, the position PATCH calls are triggered automatically by the client’s GPS/location system: every time a new position is registered by the client,\n   * a PATCH call is sent to let the server know and the server acts accordingly by adjusting the underlying music mix as well as modifying the playlist of available assets to be played.\n   * @param {Object} data [{}]\n   * **/\n  update(data = {}) {\n    if (this._streamApiPath) {\n      let updateStreamData = new FormData();\n\n      updateStreamData.append('session_id',this._sessionId);\n      updateStreamData.append('latitude',data.latitude);\n      updateStreamData.append('longitude',data.longitude);\n      updateStreamData.append('tag_ids',data.tagIds);\n      if ('listener_range_max' in data) {\n        updateStreamData.append('listener_range_max',data.listener_range_max);\n      }\n      if ('listener_range_min' in data) {\n        updateStreamData.append('listener_range_min',data.listener_range_min);\n      }\n\n      data.session_id = this._sessionId;\n      return this._apiClient.patch(this._streamApiPath,updateStreamData,{\n        cache: true, // to avoid CORS problems TODO remove this\n        processData: false,\n        contentType: 'multipart/form-data'\n      });\n    }\n  }\n\n  /** Tells Roundware server to kill the audio stream **/\n  kill() {\n    clearInterval(heartbeatIntervalId);\n    if (this._streamAudioUrl) {\n      let killPlayingPath = `${this._streamApiPath}kill/`;\n      this._apiClient.post(killPlayingPath);\n    }\n  }\n\n  /** Tells Roundware server to replay the current asset **/\n  replay() {\n    if (this._streamAudioUrl) {\n      let replayPlayingPath = `${this._streamApiPath}replayasset/`;\n      this._apiClient.post(replayPlayingPath);\n    }\n  }\n\n  /** Tells Roundware server to skip the current asset **/\n  skip() {\n    if (this._streamAudioUrl) {\n      let skipPlayingPath = `${this._streamApiPath}skipasset/`;\n      this._apiClient.post(skipPlayingPath);\n    }\n  }\n}\n\n/**\n * This callback is invoked by play() the first time we connect to Roundware and get an audio stream URL\n * @callback Streamam~firstPlayCallback\n * @param {string} streamAudioUrl - the URL of the stream, ready to connect to an audio source for playback\n */\n\n\n\n// WEBPACK FOOTER //\n// ./src/stream.js","import { logger } from \"./shims\";\n\nvar deviceId, clientType, userName, apiClient;\nvar authToken = \"UNKNOWN\";\nvar userName = \"(anonymous)\";\n\n/** Responsible for identifying the user to the Roundware server and retrieving an auth token **/\nexport class User {\n  /** Create a User\n   * @param {Object} options - Various configuration parameters for this user\n   * @param {apiClient} options.apiClient - the API client object to use for server API calls\n   * @param {String} options.deviceId - this value distinguishes a particular user, who may be anonymous, to the server; by default we will fingerprint the browser to get this value, but you can supply your own value (useful if your app has a preexisting authorization scheme)\n   * @param {String} [options.clientType = \"web\"] \n   **/\n  constructor(options) {\n    apiClient = options.apiClient;\n\n    // TODO need to try to persist deviceId as a random value that can partially serve as \"a unique identifier generated by the client\" that can \n    // used to claim a anonymous user's contributions. Some ideas for implementation: https://clientjs.org/ and https://github.com/Valve/fingerprintjs2\n    deviceId = options.deviceId || \"00000000000000\"; \n    clientType = options.clientType || \"web\";\n  }\n\n  /** @returns {String} human-readable representation of this user **/\n  toString() {\n    return `User ${userName} (deviceId ${deviceId})`;\n  }\n\n  /** Make an API call to associate the (possibly anonymous) application user with a Roundware user account.\n   * Upon success, this function receives an auth token, which is passed onto the apiClient object.\n   * @returns {Promise} represents the pending API call **/\n  connect() {\n    var data = {\n      device_id: deviceId,\n      client_type: clientType\n    };\n\n    // TODO need to also handle auth failures\n    return apiClient.post(\"/users/\",data).\n      then((data) => {\n        userName = data.username;\n        apiClient.setAuthToken(data.token);\n      });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/user.js","/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n\n    function realMethod(methodName) {\n        if (typeof console === undefinedType) {\n            return false; // We can't build a real method without a console to log to\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // these private functions always need `this` to be set properly\n\n    function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this, level, loggerName);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    function replaceLoggingMethods(level, loggerName) {\n        /*jshint validthis:true */\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, loggerName);\n        }\n    }\n\n    function defaultMethodFactory(methodName, level, loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    function Logger(name, defaultLevel, factory) {\n      var self = this;\n      var currentLevel;\n      var storageKey = \"loglevel\";\n      if (name) {\n        storageKey += \":\" + name;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var location = cookie.indexOf(\n                      encodeURIComponent(storageKey) + \"=\");\n                  if (location) {\n                      storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      /*\n       *\n       * Public API\n       *\n       */\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          return currentLevel;\n      };\n\n      self.setLevel = function (level, persist) {\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              currentLevel = level;\n              if (persist !== false) {  // defaults to true\n                  persistLevelIfPossible(level);\n              }\n              replaceLoggingMethods.call(self, level, name);\n              if (typeof console === undefinedType && level < self.levels.SILENT) {\n                  return \"No console available for logging\";\n              }\n          } else {\n              throw \"log.setLevel() called with invalid level: \" + level;\n          }\n      };\n\n      self.setDefaultLevel = function (level) {\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      // Initialize with the right level\n      var initialLevel = getPersistedLevel();\n      if (initialLevel == null) {\n          initialLevel = defaultLevel == null ? \"WARN\" : defaultLevel;\n      }\n      self.setLevel(initialLevel, false);\n    }\n\n    /*\n     *\n     * Package-level API\n     *\n     */\n\n    var defaultLogger = new Logger();\n\n    var _loggersByName = {};\n    defaultLogger.getLogger = function getLogger(name) {\n        if (typeof name !== \"string\" || name === \"\") {\n          throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n          logger = _loggersByName[name] = new Logger(\n            name, defaultLogger.getLevel(), defaultLogger.methodFactory);\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    return defaultLogger;\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/loglevel/lib/loglevel.js\n// module id = 11\n// module chunks = 0","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/process/browser.js\n// module id = 12\n// module chunks = 0"],"sourceRoot":""}